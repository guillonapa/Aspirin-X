<%= form_with(model: assignment, remote: true, authenticity_token: true) do |form| %>
  <% if assignment.errors.any? %>
    <div id="error_explanation">
      <div class="alert alert-danger" role="alert">
        <h2><%= pluralize(assignment.errors.count, "error") %> prohibited this assignment from being saved:</h2>
        <ul>
        <% assignment.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
        </ul>
      </div>
    </div>
  <% end %>

  <div class="row" style="margin-left: 0; margin-right: 0">
    <div class="col-lg-5 assignment-details">
      <div class="container">
        <h3 style="padding-top:20px">New/Edit Assignment</small></h3>
        <hr/>
        <%= form.hidden_field :course_id, value: params['course_id'] %>
        <dl class="row">
          <dt class="col-sm-3">Name</dt>
          <dd class="col-sm-9">
            <%= form.text_field :name, id: :assignment_name, class: "form-control" %>
          </dd>
          <dt class="col-sm-3">Instructions</dt>
          <dd class="col-sm-9">
            <%= form.text_area :instructions, id: :assignment_instructions, class: "form-control", rows: "15" %>
          </dd>
          <dt class="col-sm-3">Due Date</dt>
          <dd class="col-sm-9">
            <%= form.datetime_select :due_date, id: :assignment_due_date, class: "form-control" %>
          </dd>
        </dl>
        <hr/>
      </div>
    </div>
    <div class="col-lg-7" style="padding-right: 0">
      <%= form.text_area :template, id: :assignment_template %>
      <%= token_tag(nil) %>
      <pre id="editor" style="margin-bottom: 0px" class="editor-div"></pre>
      <div class="container" style="background-color: #eaecef; padding: 10px;">
      <div class="row" style="margin: 0px">
        <div class="col-8">
        </div>
        <div class="col-4">
          <%= form.submit "Save", class: "btn btn-success ml-auto w-100" %>
        </div>
      </div>
    </div>
    </div>
  </div>

  <script>
  <%= render 'shared/editor.js' %>
  var input = $('textarea[id="assignment_template"]').hide()
  editor.setValue("")
  <% if @assignment.template.inspect != 'nil' %>
  editor.setValue("<%= raw(@assignment.template.inspect[1..-2]) %>", 1)
  <% end %>
  editor.getSession().on('change', () => input.val(editor.getSession().getValue()))
  </script>
<% end %>
